# ExploitedDucks
A super simple Cisa KEV lookup CLI tool leveraging DuckDB

## Table of contents
* [Features](#features)
* [Setup](#setup)
* [HowTo](#howto)

## Features
- Search Cisa Kev endpoint.
- Output unique results from Cisa KEV leveraging DuckDB/SQL to CSV or Parquet file.
- Fetch information in the CLI From the KEV

## Setup

### Prerequisites

#### Enviroment
```
1.) ensure you have python 3.x installed 
$ python3 -m venv /path/you/want/the/env/in
$ source /path/you/want/the/env/in/bin/activate 
```
#### Clone repository 

        $ git clone https://github.com/ChalkingCode/ExploitedDucks.git
        $ cd ExploitedDucks


#### Install Packages on env
```       
duckdb
requests

# This only needs to be ran once per env 
$ pip install -r requirements.txt
```
## HowTo

How to run the script that will search and grab your data  

```	
$ python exploited_ducks.py
----------------------------------------------
|                                             |
|                                             |
|                                             |
|              Exploited Duck                 |
|                                             |
|        Simple Cisa kev lookup by cve        |
|               KEV and duckdb                |
|                  created by                 |
|                 CHALKINGCODE                |
|                                             |
|                                             |
----------------------------------------------
Have you ever ran this script before and have the json data (yes or no)?  no

What cve would you like to look up in the kev if all type ; if you would like to find others use sql commands starting by WHERE
                                    for example: WHERE kevcves.cveID='CVE-2021-27102' OR kevcves.cveID='CVE-2021-27104'
                                          another example: WHERE kevcves.knownRansomwareCampaignUSE='Known'

                                                               type sql here:   ;

Thanks for using duckduckgoose we are now looking for your ducks

Generating kev data and writing out to json file
┌────────────────┬───────────────────┬──────────────────────┬──────────────────────┬────────────┬───┬──────────────────────┬────────────┬──────────────────────┬──────────────────────┬────────┐
│     cveID      │   vendorProject   │       product        │  vulnerabilityName   │ dateAdded  │ … │    requiredAction    │  dueDate   │ knownRansomwareCam…  │        notes         │  cwes  │
│    varchar     │      varchar      │       varchar        │       varchar        │    date    │   │       varchar        │    date    │       varchar        │       varchar        │ json[] │
├────────────────┼───────────────────┼──────────────────────┼──────────────────────┼────────────┼───┼──────────────────────┼────────────┼──────────────────────┼──────────────────────┼────────┤
│ CVE-2021-27104 │ Accellion         │ FTA                  │ Accellion FTA OS C…  │ 2021-11-03 │ … │ Apply updates per …  │ 2021-11-17 │ Known                │                      │ []     │
│ CVE-2021-27102 │ Accellion         │ FTA                  │ Accellion FTA OS C…  │ 2021-11-03 │ … │ Apply updates per …  │ 2021-11-17 │ Known                │                      │ []     │
│ CVE-2021-27101 │ Accellion         │ FTA                  │ Accellion FTA SQL …  │ 2021-11-03 │ … │ Apply updates per …  │ 2021-11-17 │ Known                │                      │ []     │
│ CVE-2021-27103 │ Accellion         │ FTA                  │ Accellion FTA Serv…  │ 2021-11-03 │ … │ Apply updates per …  │ 2021-11-17 │ Known                │                      │ []     │
│ CVE-2021-21017 │ Adobe             │ Acrobat and Reader   │ Adobe Acrobat and …  │ 2021-11-03 │ … │ Apply updates per …  │ 2021-11-17 │ Unknown              │                      │ []     │
│ CVE-2021-28550 │ Adobe             │ Acrobat and Reader   │ Adobe Acrobat and …  │ 2021-11-03 │ … │ Apply updates per …  │ 2021-11-17 │ Unknown              │                      │ []     │
│ CVE-2018-4939  │ Adobe             │ ColdFusion           │ Adobe ColdFusion D…  │ 2021-11-03 │ … │ Apply updates per …  │ 2022-05-03 │ Unknown              │                      │ []     │
│ CVE-2018-15961 │ Adobe             │ ColdFusion           │ Adobe ColdFusion U…  │ 2021-11-03 │ … │ Apply updates per …  │ 2022-05-03 │ Unknown              │                      │ []     │
│ CVE-2018-4878  │ Adobe             │ Flash Player         │ Adobe Flash Player…  │ 2021-11-03 │ … │ The impacted produ…  │ 2022-05-03 │ Known                │                      │ []     │
│ CVE-2020-5735  │ Amcrest           │ Cameras and Networ…  │ Amcrest Cameras an…  │ 2021-11-03 │ … │ Apply updates per …  │ 2022-05-03 │ Unknown              │                      │ []     │
│       ·        │   ·               │        ·             │          ·           │     ·      │ · │          ·           │     ·      │    ·                 │          ·           │ ·      │
│       ·        │   ·               │        ·             │          ·           │     ·      │ · │          ·           │     ·      │    ·                 │          ·           │ ·      │
│       ·        │   ·               │        ·             │          ·           │     ·      │ · │          ·           │     ·      │    ·                 │          ·           │ ·      │
│ CVE-2017-3506  │ Oracle            │ WebLogic Server      │ Oracle WebLogic Se…  │ 2024-06-03 │ … │ Apply mitigations …  │ 2024-06-24 │ Unknown              │ https://www.oracle…  │ []     │
│ CVE-2024-4577  │ PHP Group         │ PHP                  │ PHP-CGI OS Command…  │ 2024-06-12 │ … │ Apply mitigations …  │ 2024-07-03 │ Known                │ This vulnerability…  │ []     │
│ CVE-2024-4610  │ Arm               │ Mali GPU Kernel Dr…  │ Arm Mali GPU Kerne…  │ 2024-06-12 │ … │ Apply mitigations …  │ 2024-07-03 │ Unknown              │ https://developer.…  │ []     │
│ CVE-2024-4358  │ Progress          │ Telerik Report Ser…  │ Progress Telerik R…  │ 2024-06-13 │ … │ Apply mitigations …  │ 2024-07-04 │ Unknown              │ https://docs.teler…  │ []     │
│ CVE-2024-26169 │ Microsoft         │ Windows              │ Microsoft Windows …  │ 2024-06-13 │ … │ Apply updates per …  │ 2024-07-04 │ Known                │ https://msrc.micro…  │ []     │
│ CVE-2024-32896 │ Android           │ Pixel                │ Android Pixel Priv…  │ 2024-06-13 │ … │ Apply mitigations …  │ 2024-07-04 │ Unknown              │ https://source.and…  │ []     │
│ CVE-2020-13965 │ Roundcube         │ Webmail              │ Roundcube Webmail …  │ 2024-06-26 │ … │ Apply mitigations …  │ 2024-07-17 │ Unknown              │ https://roundcube.…  │ []     │
│ CVE-2022-2586  │ Linux             │ Kernel               │ Linux Kernel Use-A…  │ 2024-06-26 │ … │ Apply updates per …  │ 2024-07-17 │ Unknown              │ This vulnerability…  │ []     │
│ CVE-2022-24816 │ GeoSolutionsGroup │ JAI-EXT              │ GeoSolutionsGroup …  │ 2024-06-26 │ … │ Apply mitigations …  │ 2024-07-17 │ Unknown              │ This vulnerability…  │ []     │
│ CVE-2024-20399 │ Cisco             │ NX-OS                │ Cisco NX-OS Comman…  │ 2024-07-02 │ … │ Apply mitigations …  │ 2024-07-23 │ Unknown              │ https://sec.clouda…  │ []     │
├────────────────┴───────────────────┴──────────────────────┴──────────────────────┴────────────┴───┴──────────────────────┴────────────┴──────────────────────┴──────────────────────┴────────┤
│ 1127 rows (20 shown)                                                                                                                                                   11 columns (10 shown) │
└──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘

What file type would you like your results written out to parquet or csv? csv

$ python exploited_ducks.py
----------------------------------------------
|                                             |
|                                             |
|                                             |
|              Exploited Duck                 |
|                                             |
|        Simple Cisa kev lookup by cve        |
|               KEV and duckdb                |
|                  created by                 |
|                 CHALKINGCODE                |
|                                             |
|                                             |
----------------------------------------------
Have you ever ran this script before and have the json data (yes or no)?  yes

What cve would you like to look up in the kev if all type ; if you would like to find others use sql commands starting by WHERE
                                    for example: WHERE kevcves.cveID='CVE-2021-27102' OR kevcves.cveID='CVE-2021-27104'
                                          another example: WHERE kevcves.knownRansomwareCampaignUSE='Known'

                                                               type sql here:   WHERE kevcves.knownRansomwareCampaignUSE='Known'

Thanks for using duckduckgoose we are now looking for your ducks

┌────────────────┬───────────────┬──────────────────────┬──────────────────────┬────────────┬───┬──────────────────────┬────────────┬──────────────────────┬──────────────────────┬────────┐
│     cveID      │ vendorProject │       product        │  vulnerabilityName   │ dateAdded  │ … │    requiredAction    │  dueDate   │ knownRansomwareCam…  │        notes         │  cwes  │
│    varchar     │    varchar    │       varchar        │       varchar        │    date    │   │       varchar        │    date    │       varchar        │       varchar        │ json[] │
├────────────────┼───────────────┼──────────────────────┼──────────────────────┼────────────┼───┼──────────────────────┼────────────┼──────────────────────┼──────────────────────┼────────┤
│ CVE-2021-27104 │ Accellion     │ FTA                  │ Accellion FTA OS C…  │ 2021-11-03 │ … │ Apply updates per …  │ 2021-11-17 │ Known                │                      │ []     │
│ CVE-2021-27102 │ Accellion     │ FTA                  │ Accellion FTA OS C…  │ 2021-11-03 │ … │ Apply updates per …  │ 2021-11-17 │ Known                │                      │ []     │
│ CVE-2021-27101 │ Accellion     │ FTA                  │ Accellion FTA SQL …  │ 2021-11-03 │ … │ Apply updates per …  │ 2021-11-17 │ Known                │                      │ []     │
│ CVE-2021-27103 │ Accellion     │ FTA                  │ Accellion FTA Serv…  │ 2021-11-03 │ … │ Apply updates per …  │ 2021-11-17 │ Known                │                      │ []     │
│ CVE-2018-4878  │ Adobe         │ Flash Player         │ Adobe Flash Player…  │ 2021-11-03 │ … │ The impacted produ…  │ 2022-05-03 │ Known                │                      │ []     │
│ CVE-2021-42013 │ Apache        │ HTTP Server          │ Apache HTTP Server…  │ 2021-11-03 │ … │ Apply updates per …  │ 2021-11-17 │ Known                │                      │ []     │
│ CVE-2021-41773 │ Apache        │ HTTP Server          │ Apache HTTP Server…  │ 2021-11-03 │ … │ Apply updates per …  │ 2021-11-17 │ Known                │                      │ []     │
│ CVE-2017-5638  │ Apache        │ Struts               │ Apache Struts Remo…  │ 2021-11-03 │ … │ Apply updates per …  │ 2022-05-03 │ Known                │                      │ []     │
│ CVE-2021-26084 │ Atlassian     │ Confluence Server …  │ Atlassian Confluen…  │ 2021-11-03 │ … │ Apply updates per …  │ 2021-11-17 │ Known                │                      │ []     │
│ CVE-2019-3396  │ Atlassian     │ Confluence Server …  │ Atlassian Confluen…  │ 2021-11-03 │ … │ Apply updates per …  │ 2022-05-03 │ Known                │                      │ []     │
│       ·        │     ·         │         ·            │          ·           │     ·      │ · │          ·           │     ·      │   ·                  │          ·           │ ·      │
│       ·        │     ·         │         ·            │          ·           │     ·      │ · │          ·           │     ·      │   ·                  │          ·           │ ·      │
│       ·        │     ·         │         ·            │          ·           │     ·      │ · │          ·           │     ·      │   ·                  │          ·           │ ·      │
│ CVE-2023-29357 │ Microsoft     │ SharePoint Server    │ Microsoft SharePoi…  │ 2024-01-10 │ … │ Apply mitigations …  │ 2024-01-31 │ Known                │ https://msrc.micro…  │ []     │
│ CVE-2023-35082 │ Ivanti        │ Endpoint Manager M…  │ Ivanti Endpoint Ma…  │ 2024-01-18 │ … │ Apply mitigations …  │ 2024-02-08 │ Known                │ https://forums.iva…  │ []     │
│ CVE-2023-22527 │ Atlassian     │ Confluence Data Ce…  │ Atlassian Confluen…  │ 2024-01-24 │ … │ Apply mitigations …  │ 2024-02-14 │ Known                │ https://confluence…  │ []     │
│ CVE-2020-3259  │ Cisco         │ Adaptive Security …  │ Cisco ASA and FTD …  │ 2024-02-15 │ … │ Apply mitigations …  │ 2024-03-07 │ Known                │ https://tools.cisc…  │ []     │
│ CVE-2024-1709  │ ConnectWise   │ ScreenConnect        │ ConnectWise Screen…  │ 2024-02-22 │ … │ Apply mitigations …  │ 2024-02-29 │ Known                │ https://www.connec…  │ []     │
│ CVE-2024-27198 │ JetBrains     │ TeamCity             │ JetBrains TeamCity…  │ 2024-03-07 │ … │ Apply mitigations …  │ 2024-03-28 │ Known                │ https://www.jetbra…  │ []     │
│ CVE-2023-48788 │ Fortinet      │ FortiClient EMS      │ Fortinet FortiClie…  │ 2024-03-25 │ … │ Apply mitigations …  │ 2024-04-15 │ Known                │ https://www.fortig…  │ []     │
│ CVE-2023-24955 │ Microsoft     │ SharePoint Server    │ Microsoft SharePoi…  │ 2024-03-26 │ … │ Apply mitigations …  │ 2024-04-16 │ Known                │ https://msrc.micro…  │ []     │
│ CVE-2024-4577  │ PHP Group     │ PHP                  │ PHP-CGI OS Command…  │ 2024-06-12 │ … │ Apply mitigations …  │ 2024-07-03 │ Known                │ This vulnerability…  │ []     │
│ CVE-2024-26169 │ Microsoft     │ Windows              │ Microsoft Windows …  │ 2024-06-13 │ … │ Apply updates per …  │ 2024-07-04 │ Known                │ https://msrc.micro…  │ []     │
├────────────────┴───────────────┴──────────────────────┴──────────────────────┴────────────┴───┴──────────────────────┴────────────┴──────────────────────┴──────────────────────┴────────┤
│ 227 rows (20 shown)                                                                                                                                                11 columns (10 shown) │
└──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘

What file type would you like your results written out to parquet or csv? csv
```
